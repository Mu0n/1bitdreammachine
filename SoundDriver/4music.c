#include "Sound.h"#include "Misc.c"#include "math.h"#define PI 3.141593#define kBase 1024Wave gInst[4];void Music(void);void DrawWaveTable(int which);void CorrectWaveTable(Point where, int which);void main(void)  {  InitMacStuff();    WholeScreen(white,true);    Music();    }    void Music(void)  {  int i,rate1,rate2,rate3,rate4;  FTSoundRec mySnd;  FTSynthRec myRec;    EventRecord wutup;  Rect r;    SetRect(&r,0,300-255,256,301);      for(i=0;i<256;i++)    {    gInst[0][i] = 120*sin(2*i*PI/255)+128;    gInst[1][i] = gInst[0][i];      gInst[2][i] = gInst[0][i];      gInst[3][i] = gInst[0][i];      }      DrawWaveTable(0);    mySnd.duration = 1000;  mySnd.sound1Rate = FixRatio(1,1);        mySnd.sound2Rate = FixRatio(3,2);        mySnd.sound3Rate = FixRatio(2,1);        mySnd.sound4Rate = FixRatio(10,7);  mySnd.sound1Phase = 0;  mySnd.sound2Phase = 0;  mySnd.sound3Phase = 0;  mySnd.sound4Phase = 0;  mySnd.sound1Wave = &gInst[0];      mySnd.sound2Wave = &gInst[1];      mySnd.sound3Wave = &gInst[2];      mySnd.sound4Wave = &gInst[3];    myRec.mode = ftMode;  myRec.sndRec = &mySnd;    StartSound(&myRec,256,nil);  rate1=kBase;  rate2=kBase;  rate3=kBase;  rate4=kBase;        while(wutup.what != keyDown)    {    mySnd.duration = 1000;        GetNextEvent(everyEvent,&wutup);    switch(wutup.what)      {      case keyDown:        break;      case mouseDown:        while(wutup.what != mouseUp)          {          if(PtInRect(wutup.where,&r))            {            CorrectWaveTable(wutup.where,0);            }          GetNextEvent(everyEvent,&wutup);          }        break;      }   /* rate1=rate1 + rate1/8;    mySnd.sound1Rate = FixRatio(rate1,256);    if(rate1 > 2*kBase)      {      rate2=rate2 + rate2/8;      mySnd.sound2Rate = FixRatio(rate2,256);      if(rate2 > 2*kBase)        {        rate3=rate3 + rate3/8;        mySnd.sound3Rate = FixRatio(rate3,256);        if(rate3 > 2*kBase)          {          rate3=rate4 + rate4/8;          mySnd.sound4Rate = FixRatio(rate4,256);          if(rate4 > 2*kBase) rate4=kBase;                    }        }      }      */        }        StopSound();  }  void DrawWaveTable(int which)  {  int i;  Rect r;      for(i=0;i<256;i++)    {    MoveTo(i,300-gInst[which][i]);    LineTo(i,300-gInst[which][i]);      }  }  void CorrectWaveTable(Point where, int which)  {  GlobalToLocal(&where);  MoveTo(where.h,0);  PenMode(patBic);  LineTo(where.h,301);  MoveTo(where.h,where.v);  PenMode(patCopy);  LineTo(where.h,where.v);    gInst[which][where.h]=300-where.v;  }